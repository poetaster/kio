From afadd2592b1ed12d211b51a91230eddd446f7d74 Mon Sep 17 00:00:00 2001
From: Mark Washeim <blueprint@poetaster.de>
Date: Fri, 21 Apr 2023 14:24:33 +0200
Subject: [PATCH] Spec: remove X11 dep for SFOS. reduce to core, add patch

---
 CMakeLists.txt | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index 3d4302f80..3d6d862b2 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -37,7 +37,7 @@ ecm_setup_version(
 
 set(EXCLUDE_DEPRECATED_BEFORE_AND_AT 0 CACHE STRING "Control the range of deprecated API excluded from the build [default=0].")
 
-option(KIOCORE_ONLY "Only compile KIOCore, not KIOWidgets or anything that depends on it. This will disable support for cookies and passwordhandling (prompting and storing)." OFF)
+option(KIOCORE_ONLY "Only compile KIOCore, not KIOWidgets or anything that depends on it. This will disable support for cookies and passwordhandling (prompting and storing)." ON)
 
 # Enable state assertion by default on Jenkins and from-git builds.
 # This option should eventually be dropped and always be enabled.
@@ -55,7 +55,7 @@ option(KIO_NO_PUBLIC_QTCONCURRENT "Privatize QtConcurrent linking, so KIO does n
 option(BUILD_QCH "Build API documentation in QCH format (for e.g. Qt Assistant, Qt Creator & KDevelop)" OFF)
 add_feature_info(QCH ${BUILD_QCH} "API documentation in QCH format (for e.g. Qt Assistant, Qt Creator & KDevelop)")
 
-option(BUILD_DESIGNERPLUGIN "Build plugin for Qt Designer" ON)
+option(BUILD_DESIGNERPLUGIN "Build plugin for Qt Designer" OFF)
 add_feature_info(DESIGNERPLUGIN ${BUILD_DESIGNERPLUGIN} "Build plugin for Qt Designer")
 
 option(USE_FTPD_WSGIDAV_UNITTEST "Use ftpd Ruby Gem (for ftptest) and wsgidav Python module (for webdavtest) in unittests. Note that this is a temporary option that will be removed when distros add those packages in their repos." OFF)
@@ -90,7 +90,7 @@ set_package_properties(KDED PROPERTIES DESCRIPTION "Daemon providing session ser
                       )
 endif()
 
-if (UNIX AND NOT ANDROID)
+if (UNIX AND NOT ANDROID AND NOT KIOCORE_ONLY) # hack sailfish
     find_package(KF5Auth ${KF_DEP_VERSION} REQUIRED)
 endif()
 
@@ -120,7 +120,7 @@ set_package_properties(GSSAPI PROPERTIES DESCRIPTION "Allows KIO to make use of
                       )
 
 if (NOT APPLE AND NOT WIN32 AND NOT ANDROID)
-    option(WITH_X11 "Build with X11 integration" ON)
+    option(WITH_X11 "Build with X11 integration" OFF) # sailfishos hack
     if(WITH_X11)
         if (QT_MAJOR_VERSION STREQUAL "5")
             find_package(Qt5 ${REQUIRED_QT_VERSION} CONFIG REQUIRED X11Extras)
-- 
2.34.1

